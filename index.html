<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learning English - 在线学习平台</title>
    <style>
        /* --- 基础样式 --- */
        :root { --primary: #4e54c8; --secondary: #8f94fb; }
        body { margin: 0; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: #f4f6f8; color: #333; height: 100vh; overflow: hidden; }
        
        /* --- 1. 登录/注册页样式 --- */
        #auth-section {
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            height: 100vh; background: linear-gradient(to right, #4e54c8, #8f94fb); color: white;
            transition: opacity 0.5s ease;
        }
        .auth-box { 
            width: 360px; background: white; padding: 40px; border-radius: 12px; 
            box-shadow: 0 15px 35px rgba(0,0,0,0.2); color: #333; text-align: center;
        }
        .logo-area { margin-bottom: 30px; }
        .logo-area h1 { margin: 0; font-size: 26px; color: var(--primary); font-weight: 700; }
        .logo-area p { margin: 5px 0 0; color: #666; font-size: 14px; }

        /* 切换标签 */
        .tabs { display: flex; margin-bottom: 25px; border-bottom: 1px solid #eee; }
        .tab { flex: 1; padding: 10px; cursor: pointer; color: #999; font-weight: 500; transition: 0.3s; }
        .tab.active { color: var(--primary); border-bottom: 2px solid var(--primary); }

        /* 表单控件 */
        .form-group { margin-bottom: 15px; text-align: left; }
        .form-group label { display: block; font-size: 12px; color: #666; margin-bottom: 5px; }
        input[type="text"], input[type="password"], input[type="email"] {
            width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; 
            outline: none; box-sizing: border-box; transition: 0.3s; font-size: 14px;
        }
        input:focus { border-color: var(--primary); background: #f9f9ff; }

        button.btn-primary {
            width: 100%; background: var(--primary); color: white; border: none; padding: 12px; 
            font-size: 16px; border-radius: 6px; cursor: pointer; margin-top: 10px; font-weight: bold;
            transition: background 0.3s;
        }
        button.btn-primary:hover { background: #3d42b3; }
        
        .toggle-text { margin-top: 15px; font-size: 13px; color: #666; }
        .toggle-text span { color: var(--primary); cursor: pointer; font-weight: bold; }
        .error-msg { color: #e74c3c; font-size: 13px; margin-top: 10px; min-height: 18px; }

        /* --- 2. 学习主界面样式 (保持不变，细节微调) --- */
        #classroom-section { display: none; height: 100vh; flex-direction: column; }
        .header { background: #fff; padding: 15px 30px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .header-logo { font-weight: bold; color: var(--primary); font-size: 20px; }
        .user-profile { display: flex; align-items: center; gap: 10px; font-size: 14px; }
        .logout-btn { color: #666; text-decoration: none; cursor: pointer; font-size: 12px; border: 1px solid #ddd; padding: 4px 10px; border-radius: 15px; }

        .content-wrapper { flex: 1; display: flex; padding: 20px; gap: 20px; max-width: 1200px; margin: 0 auto; width: 100%; box-sizing: border-box; }
        .video-container { flex: 2; background: #000; border-radius: 8px; overflow: hidden; display: flex; align-items: center; justify-content: center; position: relative; }
        video { width: 100%; height: auto; max-height: 100%; outline: none; }
        
        .script-container { 
            flex: 1; background: #fff; border-radius: 8px; padding: 20px; 
            overflow-y: auto; height: 60vh; border: 1px solid #e1e1e1;
        }
        .script-line { padding: 10px; margin-bottom: 8px; border-radius: 4px; cursor: pointer; transition: all 0.2s; line-height: 1.6; color: #555; font-size: 15px; }
        .script-line:hover { background-color: #f0f2ff; }
        .script-line.active { background-color: #eef2ff; border-left: 3px solid var(--primary); color: var(--primary); font-weight: 600; }
        .timestamp { font-size: 11px; color: #999; margin-right: 8px; font-family: monospace; }
    </style>
</head>
<body>

    <!-- 1. 认证中心 (登录/注册) -->
    <div id="auth-section">
        <div class="auth-box">
            <div class="logo-area">
                <h1>Learning English</h1>
                <p>沉浸式视频语言学习平台</p>
            </div>

            <!-- 选项卡 -->
            <div class="tabs">
                <div class="tab active" onclick="switchTab('login')" id="tab-login">登录</div>
                <div class="tab" onclick="switchTab('register')" id="tab-register">注册</div>
            </div>

            <!-- 登录表单 -->
            <div id="form-login">
                <div class="form-group">
                    <label>用户名 / 邮箱</label>
                    <input type="text" id="login-user" placeholder="请输入用户名">
                </div>
                <div class="form-group">
                    <label>密码</label>
                    <input type="password" id="login-pass" placeholder="请输入密码">
                </div>
                <button class="btn-primary" onclick="handleLogin()">立即登录</button>
            </div>

            <!-- 注册表单 -->
            <div id="form-register" style="display: none;">
                <div class="form-group">
                    <label>设置用户名</label>
                    <input type="text" id="reg-user" placeholder="例如: Alex">
                </div>
                <div class="form-group">
                    <label>电子邮箱</label>
                    <input type="email" id="reg-email" placeholder="name@example.com">
                </div>
                <div class="form-group">
                    <label>设置密码</label>
                    <input type="password" id="reg-pass" placeholder="6位以上字符">
                </div>
                <button class="btn-primary" onclick="handleRegister()">免费注册</button>
            </div>

            <div class="error-msg" id="error-msg"></div>
        </div>
    </div>

    <!-- 2. 学习主界面 -->
    <div id="classroom-section">
        <div class="header">
            <div class="header-logo">Learning English</div>
            <div class="user-profile">
                <span id="display-username">学员</span>
                <span class="logout-btn" onclick="logout()">退出</span>
            </div>
        </div>
        
        <div class="content-wrapper">
            <div class="video-container">
                <!-- 示例视频 -->
                <video id="main-video" controls crossorigin="anonymous">
                    <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
                    您的浏览器不支持 HTML5 视频。
                </video>
            </div>

            <div class="script-container" id="script-box">
                <h3 style="margin-top:0; color:#333; font-size:16px;">Video Transcript</h3>
                <div style="font-size: 12px; color: #999; margin-bottom: 15px; border-bottom:1px solid #eee; padding-bottom:10px;">
                    点击句子跳转 · 自动跟读高亮
                </div>
                
                <!-- 模拟字幕数据 -->
                <div class="script-line" data-start="0" data-end="7" onclick="seekVideo(0)">
                    <span class="timestamp">00:00</span> The Big Buck Bunny story is about a giant rabbit with a heart big as himself.
                </div>
                <div class="script-line" data-start="7.5" data-end="13" onclick="seekVideo(7.5)">
                    <span class="timestamp">00:07</span> When he wakes up inside his burrow, he is greeted by a beautiful butterfly.
                </div>
                <div class="script-line" data-start="13.5" data-end="19" onclick="seekVideo(13.5)">
                    <span class="timestamp">00:13</span> However, looking at the other side of nature, there are three rodents...
                </div>
                <div class="script-line" data-start="19.5" data-end="25" onclick="seekVideo(19.5)">
                    <span class="timestamp">00:19</span> Frank, Rinky, and Gamera. They decide to harass the poor creature.
                </div>
                <div class="script-line" data-start="25.5" data-end="35" onclick="seekVideo(25.5)">
                    <span class="timestamp">00:25</span> The rodents find great amusement in bullying the rabbit by throwing fruits at him.
                </div>
                 <div class="script-line" data-start="36" data-end="45" onclick="seekVideo(36)">
                    <span class="timestamp">00:36</span> But today is the day that the Bunny fights back to protect his forest friends!
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- 逻辑控制脚本 ---

        // 初始化：检查是否已登录
        window.onload = function() {
            const currentUser = localStorage.getItem('le_current_user');
            if (currentUser) {
                enterClassroom(currentUser);
            }
        };

        // 1. 切换 登录/注册 标签
        function switchTab(type) {
            const errorMsg = document.getElementById('error-msg');
            errorMsg.innerText = ''; // 清空错误信息

            if (type === 'login') {
                document.getElementById('form-login').style.display = 'block';
                document.getElementById('form-register').style.display = 'none';
                document.getElementById('tab-login').classList.add('active');
                document.getElementById('tab-register').classList.remove('active');
            } else {
                document.getElementById('form-login').style.display = 'none';
                document.getElementById('form-register').style.display = 'block';
                document.getElementById('tab-login').classList.remove('active');
                document.getElementById('tab-register').classList.add('active');
            }
        }

        // 2. 处理注册逻辑 (模拟)
        function handleRegister() {
            const user = document.getElementById('reg-user').value.trim();
            const pass = document.getElementById('reg-pass').value.trim();
            const errorMsg = document.getElementById('error-msg');

            if (!user || !pass) {
                errorMsg.innerText = "用户名和密码不能为空";
                return;
            }

            // 检查用户是否存在 (模拟数据库查询)
            if (localStorage.getItem('user_' + user)) {
                errorMsg.innerText = "该用户名已被注册，请直接登录";
                return;
            }

            // 保存用户数据 (模拟写入数据库)
            localStorage.setItem('user_' + user, pass);
            
            alert('注册成功！请登录。');
            switchTab('login');
            // 自动填充用户名
            document.getElementById('login-user').value = user;
        }

        // 3. 处理登录逻辑 (模拟)
        function handleLogin() {
            const user = document.getElementById('login-user').value.trim();
            const pass = document.getElementById('login-pass').value.trim();
            const errorMsg = document.getElementById('error-msg');

            // 模拟验证
            const storedPass = localStorage.getItem('user_' + user);

            if (storedPass && storedPass === pass) {
                // 登录成功
                localStorage.setItem('le_current_user', user); // 记录会话
                enterClassroom(user);
            } else {
                errorMsg.innerText = "用户名或密码错误";
                // 震动特效
                document.querySelector('.auth-box').animate([
                    { transform: 'translateX(0)' }, { transform: 'translateX(-10px)' }, 
                    { transform: 'translateX(10px)' }, { transform: 'translateX(0)' }
                ], { duration: 300 });
            }
        }

        // 4. 进入主界面
        function enterClassroom(username) {
            document.getElementById('display-username').innerText = username;
            
            const authSection = document.getElementById('auth-section');
            const classroomSection = document.getElementById('classroom-section');
            
            authSection.style.opacity = '0';
            setTimeout(() => {
                authSection.style.display = 'none';
                classroomSection.style.display = 'flex';
            }, 500);
        }

        // 5. 退出登录
        function logout() {
            if(confirm('确定要退出登录吗？')) {
                localStorage.removeItem('le_current_user');
                location.reload(); // 刷新页面回到登录页
            }
        }

        // --- 视频与字幕功能 (与之前一致) ---
        const video = document.getElementById('main-video');
        const scriptLines = document.querySelectorAll('.script-line');

        function seekVideo(time) {
            video.currentTime = time;
            video.play();
        }

        video.addEventListener('timeupdate', () => {
            const currentTime = video.currentTime;
            scriptLines.forEach(line => {
                const start = parseFloat(line.getAttribute('data-start'));
                const end = parseFloat(line.getAttribute('data-end'));
                if (currentTime >= start && currentTime < end) {
                    if (!line.classList.contains('active')) {
                        document.querySelector('.script-line.active')?.classList.remove('active');
                        line.classList.add('active');
                        line.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            });
        });
    </script>
</body>
</html>
